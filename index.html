<!DOCTYPE html>
<html lang="en" data-bs-theme="dark">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>OlmoEarth - Urban Analysis Platform</title>
    <link rel="icon" type="image/svg+xml"
        href="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAzMiAzMiI+PGNpcmNsZSBjeD0iMTYiIGN5PSIxNiIgcj0iMTUiIGZpbGw9IiMyNTYzZWIiLz48cGF0aCBmaWxsPSIjZmZmIiBkPSJtMTYgNyAyIDcgNyAyLTcgMi0yIDctMi03LTctMiA3LTJaIi8+PC9zdmc+">

    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
    <style>
        body {
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }

        .narrative {
            max-inline-size: 44rem;
        }

        .app-content {
            font-size: 1.05rem;
        }

        .app-content .small,
        .app-content small {
            font-size: 0.95rem;
        }

        .app-content .lead {
            font-size: 1.35rem;
        }

        .city-card {
            transition: all 0.2s ease;
            border: 1px solid var(--bs-border-color);
            cursor: pointer;
        }

        .city-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
            border-color: var(--bs-primary);
        }

        .city-card:active {
            transform: translateY(0);
        }

        .city-card.active {
            border-color: var(--bs-primary) !important;
            background-color: rgba(13, 110, 253, 0.05);
            box-shadow: 0 0 0 0.2rem rgba(13, 110, 253, 0.25);
        }

        .card-img-placeholder {
            height: 140px;
            background: linear-gradient(135deg, #1e293b 0%, #334155 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            color: #94a3b8;
            font-size: 3rem;
        }

        /* Viewer Section - Full Screen Overlay */
        #viewer-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            z-index: 2000;
            background: #0f172a;
            display: flex;
            flex-direction: column;
        }

        #viewer-header {
            background: rgba(15, 23, 42, 0.95);
            backdrop-filter: blur(10px);
            border-bottom: 1px solid rgba(148, 163, 184, 0.2);
            padding: 0.75rem 1.5rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            z-index: 2001;
        }

        #viewer-section {
            flex: 1;
            position: relative;
            width: 100%;
            overflow: hidden;
        }

        #viewer-frame {
            width: 100%;
            height: 100%;
            border: none;
            background: #0f172a;
            display: block;
        }

        /* Technical Deep Dive Styles */
        .tech-card {
            transition: transform 0.3s cubic-bezier(0.34, 1.56, 0.64, 1), box-shadow 0.3s ease;
        }

        .tech-card:hover {
            transform: translateY(-8px);
            box-shadow: 0 12px 24px rgba(0, 0, 0, 0.3);
        }

        .tech-icon-bg {
            position: absolute;
            top: -20px;
            right: -20px;
            font-size: 8rem;
            color: rgba(255, 255, 255, 0.03);
            transform: rotate(15deg);
            pointer-events: none;
            transition: transform 0.5s ease;
        }

        .tech-card:hover .tech-icon-bg {
            transform: rotate(0deg) scale(1.1);
        }

        .pipeline-step {
            transition: all 0.3s ease;
            margin-bottom: 0;
            z-index: 2;
        }

        .pipeline-step:hover {
            background-color: var(--bs-body-bg) !important;
            border-color: var(--bs-success) !important;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
            transform: translateX(5px);
        }

        .deep-dive-content,
        .replicate-content {
            font-size: 1.25rem;
        }

        .deep-dive-content .small,
        .replicate-content .small,
        .deep-dive-content small,
        .replicate-content small {
            font-size: 1.1rem;
        }

        .deep-dive-content .card-title,
        .replicate-content .card-title {
            font-size: 1.5rem;
        }

        .pipeline-line {
            position: absolute;
            left: 31px;
            top: 45px;
            width: 2px;
            height: 30px;
            background: var(--bs-border-color);
            z-index: 1;
        }

        .feature-icon {
            transition: transform 0.3s ease;
        }

        .feature-item:hover .feature-icon {
            transform: scale(1.1) rotate(5deg);
        }

        .fade-in-up {
            animation: fadeInUp 0.8s cubic-bezier(0.2, 0.8, 0.2, 1) forwards;
            opacity: 0;
            transform: translateY(20px);
        }

        @keyframes fadeInUp {
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }


        #loading-overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: #0f172a;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            z-index: 10;
        }

        /* Enhanced Copy Button Styles */
        .code-block-wrapper {
            position: relative;
        }

        .copy-btn {
            position: absolute;
            top: 0.5rem;
            right: 0.5rem;
            padding: 0.375rem 0.75rem;
            background: linear-gradient(135deg, rgba(13, 110, 253, 0.15) 0%, rgba(13, 110, 253, 0.25) 100%);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(13, 110, 253, 0.4);
            color: #60a5fa;
            border-radius: 0.375rem;
            cursor: pointer;
            font-size: 0.8125rem;
            font-weight: 500;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            z-index: 10;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
            display: flex;
            align-items: center;
            gap: 0.25rem;
        }

        .copy-btn:hover {
            background: linear-gradient(135deg, rgba(13, 110, 253, 0.25) 0%, rgba(13, 110, 253, 0.35) 100%);
            border-color: rgba(13, 110, 253, 0.6);
            color: #93c5fd;
            transform: translateY(-2px);
            box-shadow: 0 10px 15px -3px rgba(13, 110, 253, 0.2), 0 4px 6px -2px rgba(13, 110, 253, 0.1);
        }

        .copy-btn:active {
            transform: translateY(0);
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
        }

        .copy-btn.copied {
            background: linear-gradient(135deg, rgba(34, 197, 94, 0.15) 0%, rgba(34, 197, 94, 0.25) 100%);
            border-color: rgba(34, 197, 94, 0.5);
            color: #86efac;
            animation: successPulse 0.5s ease-out;
        }

        @keyframes successPulse {

            0%,
            100% {
                transform: scale(1);
            }

            50% {
                transform: scale(1.05);
            }
        }

        .copy-btn i {
            font-size: 1rem;
        }

        /* Enhanced code block styling */
        .code-block-wrapper {
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.3), 0 2px 4px -1px rgba(0, 0, 0, 0.2);
            transition: box-shadow 0.3s ease;
        }

        .code-block-wrapper:hover {
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.4), 0 4px 6px -2px rgba(0, 0, 0, 0.3);
        }

        /* Resource links styling */
        .resource-link {
            display: flex;
            align-items: center;
            padding: 0.75rem 1rem;
            margin-bottom: 0.5rem;
            background: linear-gradient(135deg, rgba(13, 110, 253, 0.05) 0%, rgba(13, 110, 253, 0.1) 100%);
            border: 1px solid rgba(13, 110, 253, 0.2);
            border-radius: 0.5rem;
            transition: all 0.3s ease;
            text-decoration: none;
            color: var(--bs-primary);
        }

        .resource-link:hover {
            background: linear-gradient(135deg, rgba(13, 110, 253, 0.15) 0%, rgba(13, 110, 253, 0.25) 100%);
            border-color: rgba(13, 110, 253, 0.5);
            color: var(--bs-body-color);
            transform: translateX(5px);
            box-shadow: 0 4px 6px -1px rgba(13, 110, 253, 0.3);
        }

        .resource-link i {
            margin-right: 0.75rem;
            font-size: 1.25rem;
            color: var(--bs-primary);
        }

        .resource-link:hover i {
            color: var(--bs-primary);
            opacity: 0.9;
        }

        .resource-link .fw-semibold {
            color: inherit;
            font-weight: 600;
        }

        .resource-link .text-muted {
            color: var(--bs-secondary-color) !important;
            opacity: 0.85;
        }

        .resource-link:hover .text-muted {
            opacity: 1;
            color: var(--bs-secondary-color) !important;
        }

        /* Override text-secondary for better visibility in dark mode only */
        [data-bs-theme="dark"] .text-secondary {
            color: #adb5bd !important;
        }
    </style>
</head>

<body>
    <nav class="navbar navbar-expand-lg bg-body-tertiary border-bottom" data-bs-theme="dark">
        <div class="container-fluid"><a class="navbar-brand d-flex align-items-center gap-2" href="#"><i
                    class="bi bi-globe-americas text-primary"></i>OlmoEarth </a><button class="navbar-toggler"
                type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent"
                aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation"><span
                    class="navbar-toggler-icon"></span></button>
            <div class="collapse navbar-collapse" id="navbarSupportedContent">

                <div class="nav-item dropdown ms-auto" role="group" aria-label="Toggle dark mode"
                    title="Toggle Dark Mode"><button class="dark-theme-toggle btn btn-outline-light dropdown-toggle"
                        type="button" data-bs-toggle="dropdown" aria-expanded="false"
                        aria-label="Toggle theme (light)"><i class="bi bi-circle-half"></i><span
                            class="d-lg-none ms-2">Toggle theme</span></button>
                    <ul class="dropdown-menu dropdown-menu-end">
                        <li><button class="dropdown-item" data-bs-theme-value="light" aria-pressed="false"><i
                                    class="me-2 bi bi-sun-fill"></i>Light</button></li>
                        <li><button class="dropdown-item active" data-bs-theme-value="dark" aria-pressed="true"><i
                                    class="me-2 bi bi-moon-stars-fill"></i>Dark</button></li>
                        <li><button class="dropdown-item" data-bs-theme-value="auto" aria-pressed="false"><i
                                    class="me-2 bi bi-circle-half"></i>Auto</button></li>
                    </ul>
                </div>
            </div>
        </div>
    </nav>
    <div class="container mt-5">
        <div class="text-center mb-5">
            <h1 class="display-2 fw-bold mb-3">Urban Analysis Platform</h1>
            <h2 class="display-5 text-muted mb-4">Analyze urban growth,
                vegetation,
                and density changes over time.</h2>
            <div class="mx-auto narrative text-secondary fs-4">
                <p>OlmoEarth leverages satellite imagery and machine learning to track urban evolution. Explore detailed
                    metrics for cities worldwide,
                    comparing data from 2019 to 2024. </p>
            </div>
        </div>
        <div class="app-content">
            <div id="cities-grid" class="mb-5">
                <h3 class="h4 mb-4 border-bottom pb-2">Available Cities</h3>
                <div class="row g-4">
                    <div class="col-md-6 col-lg-4">
                        <div class="card h-100 city-card" onclick="loadCity('bangalore', this)">
                            <div class="card-img-placeholder"><i class="bi bi-buildings"></i></div>
                            <div class="card-body">
                                <div class="d-flex justify-content-between align-items-start mb-2">
                                    <h5 class="card-title mb-0">Bangalore</h5><span
                                        class="badge bg-success bg-opacity-10 text-success border border-success border-opacity-10">India</span>
                                </div>
                                <p class="card-text small text-muted">IT Hub of India. Analysis of rapid
                                    urbanization and green cover loss.</p>
                                <div class="d-flex align-items-center gap-2 mt-3"><span
                                        class="badge bg-primary">Analysis
                                        Ready</span></div>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-6 col-lg-4">
                        <div class="card h-100 city-card" onclick="loadCity('chennai', this)">
                            <div class="card-img-placeholder"><i class="bi bi-water"></i></div>
                            <div class="card-body">
                                <div class="d-flex justify-content-between align-items-start mb-2">
                                    <h5 class="card-title mb-0">Chennai</h5><span
                                        class="badge bg-success bg-opacity-10 text-success border border-success border-opacity-10">India</span>
                                </div>
                                <p class="card-text small text-muted">Coastal metropolis. Tracking urban density
                                    and vegetation changes.</p>
                                <div class="d-flex align-items-center gap-2 mt-3"><span
                                        class="badge bg-primary">Analysis
                                        Ready</span></div>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-6 col-lg-4">
                        <div class="card h-100 city-card" onclick="loadCity('delhi', this)">
                            <div class="card-img-placeholder"><i class="bi bi-geo-alt"></i></div>
                            <div class="card-body">
                                <div class="d-flex justify-content-between align-items-start mb-2">
                                    <h5 class="card-title mb-0">Delhi</h5><span
                                        class="badge bg-success bg-opacity-10 text-success border border-success border-opacity-10">India</span>
                                </div>
                                <p class="card-text small text-muted">National Capital Territory.
                                    Analysis of urban expansion and green cover.</p>
                                <div class="d-flex align-items-center gap-2 mt-3"><span
                                        class="badge bg-primary">Analysis
                                        Ready</span></div>
                            </div>
                        </div>
                    </div>

                    <!-- International Cities -->
                    <div class="col-md-6 col-lg-4">
                        <div class="card h-100 city-card" onclick="loadCity('paris', this)">
                            <div class="card-img-placeholder"><i class="bi bi-torii-gate"></i></div>
                            <div class="card-body">
                                <div class="d-flex justify-content-between align-items-start mb-2">
                                    <h5 class="card-title mb-0">Paris</h5><span
                                        class="badge bg-info bg-opacity-10 text-info border border-info border-opacity-10">France</span>
                                </div>
                                <p class="card-text small text-muted">The City of Light. Analyzing green spaces and
                                    urban
                                    density in the 20 arrondissements.</p>
                                <div class="d-flex align-items-center gap-2 mt-3"><span
                                        class="badge bg-primary">Analysis
                                        Ready</span></div>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-6 col-lg-4">
                        <div class="card h-100 city-card" onclick="loadCity('london', this)">
                            <div class="card-img-placeholder"><i class="bi bi-clock"></i></div>
                            <div class="card-body">
                                <div class="d-flex justify-content-between align-items-start mb-2">
                                    <h5 class="card-title mb-0">London</h5><span
                                        class="badge bg-info bg-opacity-10 text-info border border-info border-opacity-10">UK</span>
                                </div>
                                <p class="card-text small text-muted">Historic Metropolis. Detailed ward-level analysis
                                    of
                                    urban fabric and vegetation.</p>
                                <div class="d-flex align-items-center gap-2 mt-3"><span
                                        class="badge bg-primary">Analysis
                                        Ready</span></div>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-6 col-lg-4">
                        <div class="card h-100 city-card" onclick="loadCity('singapore', this)">
                            <div class="card-img-placeholder"><i class="bi bi-building-fill"></i></div>
                            <div class="card-body">
                                <div class="d-flex justify-content-between align-items-start mb-2">
                                    <h5 class="card-title mb-0">Singapore</h5><span
                                        class="badge bg-warning bg-opacity-10 text-warning border border-warning border-opacity-10">Asia</span>
                                </div>
                                <p class="card-text small text-muted">The Garden City. High-resolution analysis of urban
                                    density and tropical vegetation.</p>
                                <div class="d-flex align-items-center gap-2 mt-3"><span
                                        class="badge bg-primary">Analysis
                                        Ready</span></div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="mb-5 mt-5 pt-5 fade-in-up deep-dive-content" style="animation-delay: 0.2s;">
                <h3 class="h4 mb-4 border-bottom pb-2">Technical Deep Dive</h3>
                <div class="row g-4">
                    <div class="col-lg-6">
                        <div class="card h-100 border-0 bg-body-tertiary tech-card overflow-hidden">
                            <div class="card-body position-relative z-1">
                                <div class="tech-icon-bg"><i class="bi bi-cpu"></i></div>
                                <h5 class="card-title d-flex align-items-center gap-2">
                                    <i class="bi bi-cpu text-primary"></i>OlmoEarth Foundation Model
                                </h5>
                                <p class="card-text mt-3 text-secondary">
                                    At the core of this platform lies the <a
                                        href="https://github.com/allenai/olmoearth_pretrain"
                                        class="text-decoration-none fw-bold text-primary">OlmoEarth Foundation
                                        Model</a>, a
                                    state-of-the-art vision transformer trained on petabytes of satellite imagery by the
                                    <a href="https://allenai.org/" class="text-decoration-none">Allen Institute for
                                        AI</a>.
                                </p>
                                <p class="card-text text-secondary">
                                    Unlike traditional remote sensing that relies on simple algebraic band combinations
                                    (like NDVI for vegetation), OlmoEarth "sees" the world semantically, understanding
                                    texture, context, and complex spatial relationships.
                                </p>
                                <div class="mt-4">
                                    <div class="feature-item p-2 rounded mb-2 d-flex align-items-center gap-3">
                                        <div class="feature-icon bg-primary bg-opacity-10 text-primary rounded p-2">
                                            <i class="bi bi-layers-fill"></i>
                                        </div>
                                        <div>
                                            <div class="fw-bold small">Vision Transformer (ViT) Architecture</div>
                                            <div class="small text-muted">Learns rich spatial features from multi-band
                                                imagery. <a href="https://arxiv.org/abs/2010.11929"
                                                    class="text-muted text-decoration-underline">Read Paper</a></div>
                                        </div>
                                    </div>
                                    <div class="feature-item p-2 rounded mb-2 d-flex align-items-center gap-3">
                                        <div class="feature-icon bg-primary bg-opacity-10 text-primary rounded p-2">
                                            <i class="bi bi-grid-3x3-gap-fill"></i>
                                        </div>
                                        <div>
                                            <div class="fw-bold small">768-Dimension Embeddings</div>
                                            <div class="small text-muted">High-fidelity vectors that encode semantic
                                                information for every 10 m x 10 m patch of earth.</div>
                                        </div>
                                    </div>
                                    <div class="feature-item p-2 rounded d-flex align-items-center gap-3">
                                        <div class="feature-icon bg-primary bg-opacity-10 text-primary rounded p-2">
                                            <i class="bi bi-intersect"></i>
                                        </div>
                                        <div>
                                            <div class="fw-bold small">Multi-Modal Fusion</div>
                                            <div class="small text-muted">Combines Sentinel-2 (Optical) and Sentinel-1
                                                (Radar) data for all-weather monitoring.</div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-lg-6">
                        <div class="card h-100 border-0 bg-body-tertiary tech-card overflow-hidden">
                            <div class="card-body position-relative z-1">
                                <div class="tech-icon-bg"><i class="bi bi-hdd-network"></i></div>
                                <h5 class="card-title d-flex align-items-center gap-2">
                                    <i class="bi bi-hdd-network text-success"></i>Our Analysis Pipeline
                                </h5>
                                <p class="card-text mt-3 text-secondary">
                                    We built an end-to-end automated pipeline to transform raw satellite data into
                                    actionable insights.
                                </p>
                                <div class="pipeline-container mt-4 d-flex flex-column gap-3">
                                    <div
                                        class="pipeline-step p-3 rounded bg-body-tertiary border border-dark-subtle position-relative">
                                        <div class="d-flex gap-3 align-items-center">
                                            <div class="step-indicator bg-success text-white rounded-circle d-flex align-items-center justify-content-center"
                                                style="width: 32px; height: 32px;">1</div>
                                            <div>
                                                <div class="fw-bold">Ingestion via STAC API</div>
                                                <div class="small text-muted">Automated querying and validation of
                                                    low-cloud imagery from <a
                                                        href="https://planetarycomputer.microsoft.com/"
                                                        class="text-muted text-decoration-underline">Microsoft Planetary
                                                        Computer</a>.</div>
                                            </div>
                                        </div>
                                    </div>
                                    <div
                                        class="pipeline-step p-3 rounded bg-body-tertiary border border-dark-subtle position-relative">
                                        <div class="d-flex gap-3 align-items-center">
                                            <div class="step-indicator bg-success text-white rounded-circle d-flex align-items-center justify-content-center"
                                                style="width: 32px; height: 32px;">2</div>
                                            <div>
                                                <div class="fw-bold">Model Inference</div>
                                                <div class="small text-muted">Runs the OlmoEarth foundation model on GPU
                                                    when available to generate dense embeddings.</div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="pipeline-step p-3 rounded bg-body-tertiary border border-dark-subtle">
                                        <div class="d-flex gap-3 align-items-center">
                                            <div class="step-indicator bg-success text-white rounded-circle d-flex align-items-center justify-content-center"
                                                style="width: 32px; height: 32px;">3</div>
                                            <div>
                                                <div class="fw-bold">Geospatial Analysis</div>
                                                <div class="small text-muted">Spatial aggregation of embeddings within
                                                    administrative boundaries (wards) to compute change metrics.</div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- How to Replicate Section -->
            <div class="mb-5 fade-in-up" style="animation-delay: 0.4s;">
                <h3 class="h4 mb-4 border-bottom pb-2">How to Replicate this Analysis</h3>
                <div class="card border-0 bg-body-tertiary">
                    <div class="card-body p-4 replicate-content">
                        <p class="lead text-secondary mb-5">
                            This analysis uses the <a href="https://github.com/allenai/rslearn"
                                class="text-primary fw-bold">rslearn</a> library
                            to download satellite imagery and the <a
                                href="https://github.com/allenai/olmoearth_pretrain"
                                class="text-primary fw-bold">OlmoEarth</a>
                            foundation model to generate semantic embeddings. Follow these steps to replicate for any
                            city.
                        </p>

                        <!-- Step 1: Installation -->
                        <div class="mb-5">
                            <h5 class="fw-bold mb-3"><i class="bi bi-download me-2 text-primary"></i>Step 1: Install
                                rslearn</h5>
                            <p class="text-secondary">Clone and install the rslearn library (requires Python 3.10+,
                                Python 3.12 recommended):</p>
                            <div class="code-block-wrapper bg-dark p-4 rounded border border-secondary shadow-sm">
                                <button class="copy-btn" onclick="copyToClipboard(this)">
                                    <i class="bi bi-clipboard"></i>Copy
                                </button>
                                <code
                                    class="d-block text-white mb-2">git clone https://github.com/allenai/rslearn.git</code>
                                <code class="d-block text-white mb-2">cd rslearn</code>
                                <code class="d-block text-white">pip install .[extra]</code>
                            </div>
                        </div>

                        <!-- Step 2: Dataset Config -->
                        <div class="mb-5">
                            <h5 class="fw-bold mb-3"><i class="bi bi-gear me-2 text-warning"></i>Step 2: Create Dataset
                                Configuration</h5>
                            <p class="text-secondary">Create a working directory and add <code>config.json</code> to
                                define data sources:</p>
                            <div class="code-block-wrapper bg-dark p-3 rounded border border-secondary shadow-sm">
                                <button class="copy-btn" onclick="copyToClipboard(this)">
                                    <i class="bi bi-clipboard"></i>Copy
                                </button>
                                <div class="d-flex justify-content-between border-bottom border-gray-700 pb-2 mb-2">
                                    <span class="text-muted small">config.json</span>
                                </div>
                                <pre class="text-info font-monospace small m-0"
                                    style="white-space: pre-wrap; max-height: 300px; overflow-y: auto;">{
  "layers": {
    "sentinel2_l2a": {
      "band_sets": [{"bands": ["B01", "B02", "B03", "B04", "B05", "B06", "B07", "B08", "B8A", "B09", "B11", "B12"], "dtype": "uint16"}],
      "data_source": {
        "class_path": "rslearn.data_sources.planetary_computer.Sentinel2",
        "init_args": {"cache_dir": "cache/planetary_computer", "harmonize": true, "sort_by": "eo:cloud_cover"},
        "ingest": true,
        "query_config": {"max_matches": 4, "period_duration": "30d", "space_mode": "PER_PERIOD_MOSAIC"}
      },
      "type": "raster"
    },
    "sentinel1": {
      "band_sets": [{"bands": ["vv", "vh"], "dtype": "float32", "nodata_vals": [-32768, -32768]}],
      "data_source": {
        "class_path": "rslearn.data_sources.planetary_computer.Sentinel1",
        "init_args": {"cache_dir": "cache/planetary_computer", "query": {"sar:instrument_mode": {"eq": "IW"}, "sar:polarizations": {"eq": ["VV", "VH"]}}},
        "ingest": true,
        "query_config": {"max_matches": 4, "period_duration": "30d", "space_mode": "PER_PERIOD_MOSAIC"}
      },
      "type": "raster"
    },
    "embeddings": {
      "band_sets": [{"dtype": "float32", "num_bands": 768}],
      "type": "raster"
    }
  }
}</pre>
                            </div>
                        </div>

                        <!-- Step 3: Create Windows -->
                        <div class="mb-5">
                            <h5 class="fw-bold mb-3"><i class="bi bi-grid-3x3 me-2 text-success"></i>Step 3: Define
                                Spatiotemporal Windows</h5>
                            <p class="text-secondary">Create windows (spatial grids) for your city. Replace coordinates
                                with your city's bounding box:</p>
                            <div class="code-block-wrapper bg-dark p-4 rounded border border-secondary shadow-sm">
                                <button class="copy-btn" onclick="copyToClipboard(this)">
                                    <i class="bi bi-clipboard"></i>Copy
                                </button>
                                <code class="d-block text-success mb-2"># For 2019 baseline</code>
                                <code
                                    class="d-block text-white mb-3">rslearn dataset add_windows --root ./dataset --group 2019 --name default --utm --resolution 10 --src_crs EPSG:4326 --box=77.4,12.8,77.8,13.2 --start 2018-01-01T00:00:00+00:00 --end 2020-01-01T00:00:00+00:00 --grid_size 1024</code>

                                <code class="d-block text-success mb-2"># For 2024 current</code>
                                <code
                                    class="d-block text-white">rslearn dataset add_windows --root ./dataset --group 2024 --name default --utm --resolution 10 --src_crs EPSG:4326 --box=77.4,12.8,77.8,13.2 --start 2023-01-01T00:00:00+00:00 --end 2025-01-01T00:00:00+00:00 --grid_size 1024</code>
                            </div>
                        </div>

                        <!-- Step 4: Download Imagery -->
                        <div class="mb-5">
                            <h5 class="fw-bold mb-3"><i class="bi bi-cloud-download me-2 text-info"></i>Step 4: Download
                                Satellite Imagery</h5>
                            <p class="text-secondary">Query, download, and process satellite images from Planetary
                                Computer:</p>
                            <div class="d-flex flex-column gap-3">
                                <div class="code-block-wrapper p-3 rounded bg-dark border border-secondary">
                                    <button class="copy-btn" onclick="copyToClipboard(this)">
                                        <i class="bi bi-clipboard"></i>Copy
                                    </button>
                                    <div class="fw-bold text-white mb-2">Prepare (Query Available Imagery)</div>
                                    <code
                                        class="d-block text-warning small">rslearn dataset prepare --root ./dataset --workers 32 --disabled-layers landsat --retry-max-attempts 5 --retry-backoff-seconds 5</code>
                                </div>
                                <div class="code-block-wrapper p-3 rounded bg-dark border border-secondary">
                                    <button class="copy-btn" onclick="copyToClipboard(this)">
                                        <i class="bi bi-clipboard"></i>Copy
                                    </button>
                                    <div class="fw-bold text-white mb-2">Ingest (Download)</div>
                                    <code
                                        class="d-block text-warning small">rslearn dataset ingest --root ./dataset --workers 16 --disabled-layers landsat --retry-max-attempts 5 --retry-backoff-seconds 5</code>
                                </div>
                                <div class="code-block-wrapper p-3 rounded bg-dark border border-secondary">
                                    <button class="copy-btn" onclick="copyToClipboard(this)">
                                        <i class="bi bi-clipboard"></i>Copy
                                    </button>
                                    <div class="fw-bold text-white mb-2">Materialize (Crop/Mosaic to Windows)</div>
                                    <code
                                        class="d-block text-warning small">rslearn dataset materialize --root ./dataset --workers 32 --no-use-initial-job --disabled-layers landsat --retry-max-attempts 5 --retry-backoff-seconds 5</code>
                                </div>
                            </div>
                        </div>

                        <!-- Step 5: Model Config -->
                        <div class="mb-5">
                            <h5 class="fw-bold mb-3"><i class="bi bi-cpu me-2 text-danger"></i>Step 5: Create Model
                                Configuration</h5>
                            <p class="text-secondary">Create <code>model.yaml</code> to configure OlmoEarth inference:
                            </p>
                            <div class="code-block-wrapper bg-dark p-3 rounded border border-secondary shadow-sm">
                                <button class="copy-btn" onclick="copyToClipboard(this)">
                                    <i class="bi bi-clipboard"></i>Copy
                                </button>
                                <div class="d-flex justify-content-between border-bottom border-gray-700 pb-2 mb-2">
                                    <span class="text-muted small">model.yaml</span>
                                </div>
                                <pre class="text-info font-monospace small m-0"
                                    style="white-space: pre-wrap; max-height: 300px; overflow-y: auto;">model:
  class_path: rslearn.train.lightning_module.RslearnLightningModule
  init_args:
    model:
      class_path: rslearn.models.singletask.SingleTaskModel
      init_args:
        encoder:
          - class_path: rslearn.models.olmoearth_pretrain.model.OlmoEarth
            init_args:
              model_id: OLMOEARTH_V1_BASE
              patch_size: 4
        decoder:
          - class_path: rslearn.train.tasks.embedding.EmbeddingHead
    optimizer:
      class_path: rslearn.train.optimizer.AdamW
data:
  class_path: rslearn.train.data_module.RslearnDataModule
  init_args:
    path: ./dataset
    inputs:
      sentinel2_l2a:
        data_type: "raster"
        layers: ["sentinel2_l2a", "sentinel2_l2a.1", "sentinel2_l2a.2", "sentinel2_l2a.3"]
        bands: ["B02", "B03", "B04", "B08", "B05", "B06", "B07", "B8A", "B11", "B12", "B01", "B09"]
        passthrough: true
        dtype: FLOAT32
        load_all_layers: true
      sentinel1:
        data_type: "raster"
        layers: ["sentinel1", "sentinel1.1", "sentinel1.2", "sentinel1.3"]
        bands: ["vv", "vh"]
        passthrough: true
        dtype: FLOAT32
        load_all_layers: true
    task:
      class_path: rslearn.train.tasks.embedding.EmbeddingTask
    batch_size: 8
    num_workers: 32
    predict_config:
      transforms:
        - class_path: rslearn.models.olmoearth_pretrain.norm.OlmoEarthNormalize
          init_args:
            band_names:
              sentinel2_l2a: ["B02", "B03", "B04", "B08", "B05", "B06", "B07", "B8A", "B11", "B12", "B01", "B09"]
              sentinel1: ["vv", "vh"]
      load_all_patches: true
      patch_size: 64
      overlap_ratio: 0.5
trainer:
  callbacks:
    - class_path: rslearn.train.prediction_writer.RslearnWriter
      init_args:
        path: placeholder
        output_layer: embeddings
        merger:
          class_path: rslearn.train.prediction_writer.RasterMerger
          init_args:
            padding: 4
            downsample_factor: 4</pre>
                            </div>
                        </div>

                        <!-- Step 6: Generate Embeddings -->
                        <div class="mb-5">
                            <h5 class="fw-bold mb-3"><i class="bi bi-lightning-charge me-2 text-warning"></i>Step 6:
                                Generate Embeddings</h5>
                            <p class="text-secondary">Run the OlmoEarth model to compute 768-dimensional embeddings:</p>
                            <div class="code-block-wrapper bg-dark p-4 rounded border border-secondary shadow-sm">
                                <button class="copy-btn" onclick="copyToClipboard(this)">
                                    <i class="bi bi-clipboard"></i>Copy
                                </button>
                                <code class="d-block text-white">rslearn model predict --config model.yaml</code>
                            </div>
                            <div class="alert alert-info mt-3 py-2 small d-flex align-items-center gap-2">
                                <i class="bi bi-info-circle-fill"></i>
                                <div>GPU is recommended but not required. The model will automatically use GPU if
                                    available.</div>
                            </div>
                        </div>

                        <!-- Step 7: Analysis -->
                        <div class="mb-5">
                            <h5 class="fw-bold mb-3"><i class="bi bi-bar-chart me-2 text-primary"></i>Step 7: Analyze
                                Ward-Level Changes</h5>
                            <p class="text-secondary">Create custom Python scripts to:</p>
                            <ul class="text-secondary">
                                <li>Load your city's ward boundaries (GeoJSON in <strong>EPSG:4326</strong>)</li>
                                <li>Extract embeddings from rslearn dataset windows</li>
                                <li>Aggregate embeddings within ward boundaries</li>
                                <li>Calculate change metrics (2019 vs 2024)</li>
                                <li>Generate visualization HTML</li>
                            </ul>
                            <div class="alert alert-warning py-2 small d-flex align-items-center gap-2">
                                <i class="bi bi-exclamation-triangle-fill"></i>
                                <div>The analysis scripts are custom and specific to your ward structure. See the <a
                                        href="https://github.com/allenai/rslearn/blob/master/docs/examples/OlmoEarthEmbeddings.md"
                                        class="text-decoration-underline" target="_blank">rslearn documentation</a> for
                                    guidance.</div>
                            </div>
                        </div>

                        <!-- Additional Resources -->
                        <div class="border-top pt-4 mt-5">
                            <h5 class="fw-bold mb-4"><i class="bi bi-book me-2 text-info"></i>Additional Resources</h5>
                            <div class="d-flex flex-column">
                                <a href="https://github.com/allenai/rslearn" class="resource-link" target="_blank">
                                    <i class="bi bi-github"></i>
                                    <div>
                                        <div class="fw-semibold">rslearn GitHub Repository</div>
                                        <small class="text-muted">Core library for remote sensing datasets and
                                            models</small>
                                    </div>
                                </a>
                                <a href="https://github.com/allenai/rslearn/blob/master/docs/examples/OlmoEarthEmbeddings.md"
                                    class="resource-link" target="_blank">
                                    <i class="bi bi-file-earmark-text"></i>
                                    <div>
                                        <div class="fw-semibold">OlmoEarth Embeddings Tutorial</div>
                                        <small class="text-muted">Step-by-step guide for computing embeddings</small>
                                    </div>
                                </a>
                                <a href="https://github.com/allenai/olmoearth_pretrain" class="resource-link"
                                    target="_blank">
                                    <i class="bi bi-cpu"></i>
                                    <div>
                                        <div class="fw-semibold">OlmoEarth Model Repository</div>
                                        <small class="text-muted">Foundation model for Earth observation</small>
                                    </div>
                                </a>
                                <a href="https://planetarycomputer.microsoft.com/" class="resource-link"
                                    target="_blank">
                                    <i class="bi bi-cloud-download"></i>
                                    <div>
                                        <div class="fw-semibold">Microsoft Planetary Computer</div>
                                        <small class="text-muted">Satellite imagery data source (Sentinel-1 &
                                            Sentinel-2)</small>
                                    </div>
                                </a>
                            </div>
                        </div>

                    </div>
                </div>
            </div>
        </div>
    </div>
    <div id="viewer-container" class="d-none">
        <div id="viewer-header">
            <h5 class="m-0 text-light" id="viewer-title">City Analysis</h5>
            <button class="btn btn-sm btn-outline-light d-flex align-items-center gap-2" onclick="closeViewer()"><i
                    class="bi bi-x-lg"></i>Close
            </button>
        </div>
        <div id="viewer-section">
            <div id="loading-overlay" class="d-none">
                <div class="spinner-border text-primary" role="status" style="width: 3rem; height: 3rem;"></div>
                <div class="mt-3 text-light">Loading Visualization...</div>
            </div><iframe id="viewer-frame" src=""></iframe>
        </div>
    </div>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script> // Theme Toggling Logic

        (() => {
            'use strict'

            const getStoredTheme = () => localStorage.getItem('theme')
            const setStoredTheme = theme => localStorage.setItem('theme', theme)
            const getPreferredTheme = () => {
                const storedTheme = getStoredTheme()
                if (storedTheme) {
                    return storedTheme
                }

                return window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light'
            }

            const setTheme = theme => {
                if (theme === 'auto' && window.matchMedia('(prefers-color-scheme: dark)').matches) {
                    document.documentElement.setAttribute('data-bs-theme', 'dark')
                }

                else {
                    document.documentElement.setAttribute('data-bs-theme', theme)
                }
            }

            setTheme(getPreferredTheme())

            const showActiveTheme = (theme, focus = false) => {
                const themeSwitcher = document.querySelector('.dark-theme-toggle')
                if (!themeSwitcher) return
                const btnToActive = document.querySelector(`[data-bs-theme-value="${theme}"]`)
                document.querySelectorAll('[data-bs-theme-value]').forEach(element => {
                    element.classList.remove('active')
                    element.setAttribute('aria-pressed', 'false')
                })
                btnToActive.classList.add('active')
                btnToActive.setAttribute('aria-pressed', 'true')
                // Update icon
                const iconClass = theme === 'dark' ? 'bi-moon-stars-fill' : (theme === 'auto' ? 'bi-circle-half' : 'bi-sun-fill');
                themeSwitcher.innerHTML = `<i class="${iconClass}"></i><span class="d-lg-none ms-2">Toggle theme</span>`;
            }

            window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', () => {
                const storedTheme = getStoredTheme()
                if (storedTheme !== 'light' && storedTheme !== 'dark') {
                    setTheme(getPreferredTheme())
                }
            })

            window.addEventListener('DOMContentLoaded', () => {
                showActiveTheme(getPreferredTheme())

                document.querySelectorAll('[data-bs-theme-value]').forEach(toggle => {
                    toggle.addEventListener('click', () => {
                        const theme = toggle.getAttribute('data-bs-theme-value')
                        setStoredTheme(theme)
                        setTheme(theme)
                        showActiveTheme(theme, true)
                    })
                })
            })
        })() // Dashboard Logic

        const cities = {
            bangalore: { url: 'bangalore.html', name: 'Bangalore Analysis' },
            chennai: { url: 'chennai.html', name: 'Chennai Analysis' },
            delhi: { url: 'delhi.html', name: 'Delhi Analysis' },
            paris: { url: 'paris.html', name: 'Paris Analysis' },
            london: { url: 'london.html', name: 'London Analysis' },
            singapore: { url: 'singapore.html', name: 'Singapore Analysis' }
        };

        function loadCity(cityKey, cardElement) {
            if (!cities[cityKey]) return;

            // Update UI active state
            document.querySelectorAll('.city-card').forEach(c => c.classList.remove('active'));
            cardElement.classList.add('active');

            const viewerContainer = document.getElementById('viewer-container');
            const frame = document.getElementById('viewer-frame');
            const loading = document.getElementById('loading-overlay');
            const title = document.getElementById('viewer-title');

            // Show viewer
            viewerContainer.classList.remove('d-none');
            loading.classList.remove('d-none');

            // Update Title
            title.innerHTML = `<i class="bi bi-geo-alt-fill text-primary me-2"></i>${cities[cityKey].name}`;

            // Load content
            frame.src = cities[cityKey].url;

            // Prevent body scroll
            document.body.style.overflow = 'hidden';

            frame.onload = () => {
                loading.classList.add('d-none');
            };
        }

        function closeViewer() {
            const viewerContainer = document.getElementById('viewer-container');
            const frame = document.getElementById('viewer-frame');

            viewerContainer.classList.add('d-none');
            frame.src = ""; // Clear src to stop resource usage

            // Re-enable body scroll
            document.body.style.overflow = 'auto';

            // Remove active classes
            document.querySelectorAll('.city-card').forEach(c => c.classList.remove('active'));
        }

        // Copy to Clipboard Function
        function copyToClipboard(button) {
            const codeBlock = button.parentElement.querySelector('pre, code');
            const text = codeBlock.textContent;

            navigator.clipboard.writeText(text).then(() => {
                // Visual feedback
                const originalHTML = button.innerHTML;
                button.innerHTML = '<i class="bi bi-check2"></i>Copied!';
                button.classList.add('copied');

                setTimeout(() => {
                    button.innerHTML = originalHTML;
                    button.classList.remove('copied');
                }, 2000);
            }).catch(err => {
                console.error('Failed to copy:', err);
                button.innerHTML = '<i class="bi bi-x"></i>Failed';
                setTimeout(() => {
                    button.innerHTML = '<i class="bi bi-clipboard"></i>Copy';
                }, 2000);
            });
        }

    </script>
</body>

</html>